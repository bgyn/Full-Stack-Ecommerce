<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("./partials/head.ejs") %>
    <title>Manage Products</title>
    <style>
      body {
        display: flex;
        min-height: 100vh;
      }
      .sidebar {
        width: 250px;
        height: 100vh;
        background-color: #343a40;
        color: white;
        padding-top: 20px;
        position: fixed;
        left: 0;
        top: 0;
      }
      .sidebar a {
        display: block;
        color: white;
        padding: 10px 20px;
        text-decoration: none;
      }
      .sidebar a:hover {
        background-color: #495057;
      }
      .content {
        margin-left: 250px;
        padding: 20px;
        flex-grow: 1;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <nav class="sidebar">
      <h3 class="text-center">Admin Panel</h3>
      <a href="/admin/users">Users</a>
      <a href="/admin/payments">Payments</a>
      <a href="/admin/categories">Categories</a>
      <a href="/admin/products" class="bg-primary">Products</a>
      <form action="/auth/logout" method="POST" class="mt-3 text-center">
        <button type="submit" class="btn btn-danger w-75">Logout</button>
      </form>
    </nav>

    <!-- Main Content -->
    <div class="content">
      <h1>Manage Products</h1>
      <h3>Add New Product</h3>
      <form id="addProductForm">
        <div class="mb-3">
          <label for="name" class="form-label">Product Name</label>
          <input
            type="text"
            id="name"
            name="name"
            class="form-control"
            placeholder="Enter product name"
            required
          />
        </div>
        <div class="mb-3">
          <label for="price" class="form-label">Price</label>
          <input
            type="number"
            id="price"
            name="price"
            class="form-control"
            placeholder="Enter product price"
            required
          />
        </div>
        <button type="submit" class="btn btn-success">Add Product</button>
      </form>
    </div>

    <script>
      document
        .getElementById("addProductForm")
        .addEventListener("submit", async function (event) {
          event.preventDefault();

          const name = document.getElementById("name").value;
          const price = document.getElementById("price").value;

          const response = await fetch("/products/add", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, price }),
          });

          const data = await response.json();

          if (response.ok) {
            alert("Product added successfully!");
            window.location.reload();
          } else {
            alert(data.message || "Failed to add product");
          }
        });
    </script>

    <%- include("./partials/script") %>
  </body>
</html>
